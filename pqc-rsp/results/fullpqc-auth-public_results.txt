Process 0 (that is, the initial process):
{1}let PK_ROOT: PQSigPK_t = pq_sig_pk(SK_ROOT_CA) in
{2}out(c, PK_ROOT);
{3}new devMain: Id_t;
(
    {4}!
    {5}let dev: Id_t = devMain in
    {6}let PK_SMDP_KEM: KEMpk_t = kem_pk(SK_SMDP_KEM) in
    {7}let id: Id_t = ID_SMDP in
    {8}let role: Tag_t = tag_dp in
    {9}let cert_tbs: bitstring = (id,PK_SMDP_KEM,role) in
    {10}let sig: PQSig_t = pq_sign(cert_tbs,SK_ROOT_CA) in
    {11}let CERT_SMDP: Cert_t = make_cert(id,PK_SMDP_KEM,role,sig) in
    {12}out(c, CERT_SMDP);
    {13}in(LPA2SMDP, (devS: Id_t,eChalS: Nonce_t,PK_EUICC_EPH: KEMpk_t,CERT_EUICC: Cert_t));
    {14}if (devS = dev) then
    {15}let id_1: Id_t = catch-fail(get_cert_id(CERT_EUICC)) in
    {16}let v: bool = not-caught-fail(id_1) in
    {17}let kempk: KEMpk_t = (if v then catch-fail(get_cert_kempk(CERT_EUICC)) else caught-fail) in
    {18}let v_1: bool = not-caught-fail(kempk) in
    {19}let role_1: Tag_t = (if v_1 then catch-fail(get_cert_role(CERT_EUICC)) else caught-fail) in
    {20}let v_2: bool = not-caught-fail(role_1) in
    {21}let sig_1: PQSig_t = (if v_2 then catch-fail(get_cert_sig(CERT_EUICC)) else caught-fail) in
    {22}let v_3: bool = not-caught-fail(sig_1) in
    {23}let cert_tbs_1: bitstring = (if v_3 then (id_1,kempk,role_1) else caught-fail) in
    {24}let (=ID_EUICC,PK_EUICC_KEM: KEMpk_t,=tag_eu) = (if v then (if v_1 then (if v_2 then (if v_3 then (if (pq_verify(sig_1,cert_tbs_1,PK_ROOT) = true) then (id_1,kempk,role_1) else (ID_LPA,kempk,role_1)) else fail-any_type) else fail-any_type) else fail-any_type) else fail-any_type) in
    {25}new tid: Tid_t;
    {26}new serverNonce: Nonce_t;
    {27}event SMDP_BEGIN(devS,tid,eChalS,serverNonce);
    {28}new r_eph: KEMcoin_t;
    {29}let CT_EPH: bitstring = kem_enc(PK_EUICC_EPH,r_eph) in
    {30}let SS_EPH: KEMss_t = kem_ss(PK_EUICC_EPH,r_eph) in
    {31}new r_client: KEMcoin_t;
    {32}let CT_CLIENT: bitstring = kem_enc(PK_EUICC_KEM,r_client) in
    {33}let SS_CLIENT: KEMss_t = kem_ss(PK_EUICC_KEM,r_client) in
    {34}event SMDP_SENT_AUTH(devS,tid,eChalS,serverNonce,ID_SMDP);
    {35}out(LPA2SMDP, (devS,tid,CT_EPH,CT_CLIENT,serverNonce,CERT_SMDP));
    {36}in(LPA2SMDP, (devS2: Id_t,tid2: Tid_t,CT_SERVER: bitstring,Finished_EU_in: bitstring));
    {37}if (devS2 = dev) then
    {38}if (tid2 = tid) then
    {39}let SS_SERVER: KEMss_t = kem_dec(CT_SERVER,SK_SMDP_KEM) in
    {40}let session_key: SessionKey_t = kemtls_kdf(SS_EPH,SS_SERVER,SS_CLIENT,eChalS,serverNonce,CT_EPH,CT_CLIENT,CT_SERVER,CERT_EUICC,CERT_SMDP,ID_EUICC,ID_SMDP) in
    {41}let KEK: KEK_t = get_KEK(session_key) in
    {42}let KM: KM_t = get_KM(session_key) in
    {43}let transcript: bitstring = transcript_hash(eChalS,serverNonce,CT_EPH,CT_CLIENT,CT_SERVER,CERT_EUICC,CERT_SMDP) in
    {44}if (Finished_EU_in = kem_mac(KM,transcript)) then
    {45}event SMDP_VERIFIED_FINISHED(dev,tid,transcript);
    {46}event SMDP_KEY(devS,tid,session_key);
    {47}let Finished_DP: bitstring = kem_mac(KM,(transcript,Finished_EU_in)) in
    {48}event SMDP_SENT_FINISHED(dev,tid,transcript);
    {49}out(LPA2SMDP, (devS,tid,Finished_DP));
    {50}event SMDP_AUTH_OK(dev,tid,serverNonce,ID_EUICC)
) | (
    {51}!
    {52}let dev_1: Id_t = devMain in
    {53}out(LPA2EUICC, (t_getChal,ID_LPA,dev_1));
    {54}in(LPA2EUICC, (dev_ch: Id_t,eChal: Nonce_t,PK_EPH: KEMpk_t,CERT_EU: Cert_t));
    {55}if (dev_ch = dev_1) then
    {56}out(LPA2SMDP, (dev_1,eChal,PK_EPH,CERT_EU));
    {57}in(LPA2SMDP, (dev2: Id_t,tid_1: Tid_t,CT_EPH_1: bitstring,CT_CLIENT_1: bitstring,serverNonce_1: Nonce_t,CERT_DP: Cert_t));
    {58}if (dev2 = dev_1) then
    {59}out(LPA2EUICC, (dev_1,tid_1,CT_EPH_1,CT_CLIENT_1,serverNonce_1,CERT_DP));
    {60}in(LPA2EUICC, (dev3: Id_t,tid2_1: Tid_t,CT_SERVER_1: bitstring,Finished_EU: bitstring));
    {61}if (dev3 = dev_1) then
    {62}out(LPA2SMDP, (dev_1,tid2_1,CT_SERVER_1,Finished_EU));
    {63}in(LPA2SMDP, (dev4: Id_t,tid3: Tid_t,Finished_DP_1: bitstring));
    {64}if (dev4 = dev_1) then
    {65}out(LPA2EUICC, (dev_1,tid3,Finished_DP_1))
) | (
    {66}!
    {67}let dev_2: Id_t = devMain in
    {68}new SK_EUICC_KEM: KEMsk_t;
    {69}let PK_EUICC_KEM_1: KEMpk_t = kem_pk(SK_EUICC_KEM) in
    {70}let id_2: Id_t = ID_EUICC in
    {71}let role_2: Tag_t = tag_eu in
    {72}let cert_tbs_2: bitstring = (id_2,PK_EUICC_KEM_1,role_2) in
    {73}let sig_2: PQSig_t = pq_sign(cert_tbs_2,SK_ROOT_CA) in
    {74}let CERT_EUICC_1: Cert_t = make_cert(id_2,PK_EUICC_KEM_1,role_2,sig_2) in
    {75}out(c, CERT_EUICC_1);
    {76}new SK_EUICC_EPH: KEMsk_t;
    {77}let PK_EUICC_EPH_1: KEMpk_t = kem_pk(SK_EUICC_EPH) in
    {78}in(LPA2EUICC, (=t_getChal,=ID_LPA,dev_in: Id_t));
    {79}if (dev_in = dev_2) then
    {80}new eChal_1: Nonce_t;
    {81}out(LPA2EUICC, (dev_2,eChal_1,PK_EUICC_EPH_1,CERT_EUICC_1));
    {82}in(LPA2EUICC, (dev_in2: Id_t,tid_2: Tid_t,CT_EPH_2: bitstring,CT_CLIENT_2: bitstring,serverNonce_2: Nonce_t,CERT_SMDP_1: Cert_t));
    {83}if (dev_in2 = dev_2) then
    {84}let id_3: Id_t = catch-fail(get_cert_id(CERT_SMDP_1)) in
    {85}let v_4: bool = not-caught-fail(id_3) in
    {86}let kempk_1: KEMpk_t = (if v_4 then catch-fail(get_cert_kempk(CERT_SMDP_1)) else caught-fail) in
    {87}let v_5: bool = not-caught-fail(kempk_1) in
    {88}let role_3: Tag_t = (if v_5 then catch-fail(get_cert_role(CERT_SMDP_1)) else caught-fail) in
    {89}let v_6: bool = not-caught-fail(role_3) in
    {90}let sig_3: PQSig_t = (if v_6 then catch-fail(get_cert_sig(CERT_SMDP_1)) else caught-fail) in
    {91}let v_7: bool = not-caught-fail(sig_3) in
    {92}let cert_tbs_3: bitstring = (if v_7 then (id_3,kempk_1,role_3) else caught-fail) in
    {93}let (=ID_SMDP,PK_SMDP_KEM_1: KEMpk_t,=tag_dp) = (if v_4 then (if v_5 then (if v_6 then (if v_7 then (if (pq_verify(sig_3,cert_tbs_3,PK_ROOT) = true) then (id_3,kempk_1,role_3) else (ID_LPA,kempk_1,role_3)) else fail-any_type) else fail-any_type) else fail-any_type) else fail-any_type) in
    {94}let SS_EPH_1: KEMss_t = kem_dec(CT_EPH_2,SK_EUICC_EPH) in
    {95}let SS_CLIENT_1: KEMss_t = kem_dec(CT_CLIENT_2,SK_EUICC_KEM) in
    {96}new r_server: KEMcoin_t;
    {97}let CT_SERVER_2: bitstring = kem_enc(PK_SMDP_KEM_1,r_server) in
    {98}let SS_SERVER_1: KEMss_t = kem_ss(PK_SMDP_KEM_1,r_server) in
    {99}let session_key_1: SessionKey_t = kemtls_kdf(SS_EPH_1,SS_SERVER_1,SS_CLIENT_1,eChal_1,serverNonce_2,CT_EPH_2,CT_CLIENT_2,CT_SERVER_2,CERT_EUICC_1,CERT_SMDP_1,ID_EUICC,ID_SMDP) in
    {100}let KEK_1: KEK_t = get_KEK(session_key_1) in
    {101}let KM_1: KM_t = get_KM(session_key_1) in
    {102}let transcript_1: bitstring = transcript_hash(eChal_1,serverNonce_2,CT_EPH_2,CT_CLIENT_2,CT_SERVER_2,CERT_EUICC_1,CERT_SMDP_1) in
    {103}let Finished_EU_1: bitstring = kem_mac(KM_1,transcript_1) in
    {104}event EUICC_SENT_FINISHED(dev_2,tid_2,transcript_1);
    {105}event EUICC_KEY(dev_2,tid_2,session_key_1);
    {106}out(c, senc_test(secret_payload,session_key_1));
    {107}out(LPA2EUICC, (dev_2,tid_2,CT_SERVER_2,Finished_EU_1));
    {108}in(LPA2EUICC, (dev_in3: Id_t,tid3_1: Tid_t,Finished_DP_in: bitstring));
    {109}if (dev_in3 = dev_2) then
    {110}if (tid3_1 = tid_2) then
    {111}if (Finished_DP_in = kem_mac(KM_1,(transcript_1,Finished_EU_1))) then
    {112}event EUICC_VERIFIED_FINISHED(dev_2,tid_2,transcript_1);
    {113}event EUICC_AUTH_OK(dev_2,tid_2,eChal_1,serverNonce_2,ID_SMDP)
) | (
    {114}phase 1;
    {115}out(c, SK_SMDP_KEM)
)

--  Process 1 (that is, process 0, with let moved downwards):
{1}let PK_ROOT: PQSigPK_t = pq_sig_pk(SK_ROOT_CA) in
{2}out(c, PK_ROOT);
{3}new devMain: Id_t;
(
    {4}!
    {8}let role: Tag_t = tag_dp in
    {7}let id: Id_t = ID_SMDP in
    {6}let PK_SMDP_KEM: KEMpk_t = kem_pk(SK_SMDP_KEM) in
    {9}let cert_tbs: bitstring = (id,PK_SMDP_KEM,role) in
    {10}let sig: PQSig_t = pq_sign(cert_tbs,SK_ROOT_CA) in
    {11}let CERT_SMDP: Cert_t = make_cert(id,PK_SMDP_KEM,role,sig) in
    {12}out(c, CERT_SMDP);
    {13}in(LPA2SMDP, (devS: Id_t,eChalS: Nonce_t,PK_EUICC_EPH: KEMpk_t,CERT_EUICC: Cert_t));
    {5}let dev: Id_t = devMain in
    {14}if (devS = dev) then
    {15}let id_1: Id_t = catch-fail(get_cert_id(CERT_EUICC)) in
    {16}let v: bool = not-caught-fail(id_1) in
    {17}let kempk: KEMpk_t = (if v then catch-fail(get_cert_kempk(CERT_EUICC)) else caught-fail) in
    {18}let v_1: bool = not-caught-fail(kempk) in
    {19}let role_1: Tag_t = (if v_1 then catch-fail(get_cert_role(CERT_EUICC)) else caught-fail) in
    {20}let v_2: bool = not-caught-fail(role_1) in
    {21}let sig_1: PQSig_t = (if v_2 then catch-fail(get_cert_sig(CERT_EUICC)) else caught-fail) in
    {22}let v_3: bool = not-caught-fail(sig_1) in
    {23}let cert_tbs_1: bitstring = (if v_3 then (id_1,kempk,role_1) else caught-fail) in
    {24}let (=ID_EUICC,PK_EUICC_KEM: KEMpk_t,=tag_eu) = (if v then (if v_1 then (if v_2 then (if v_3 then (if (pq_verify(sig_1,cert_tbs_1,PK_ROOT) = true) then (id_1,kempk,role_1) else (ID_LPA,kempk,role_1)) else fail-any_type) else fail-any_type) else fail-any_type) else fail-any_type) in
    {25}new tid: Tid_t;
    {26}new serverNonce: Nonce_t;
    {27}event SMDP_BEGIN(devS,tid,eChalS,serverNonce);
    {28}new r_eph: KEMcoin_t;
    {31}new r_client: KEMcoin_t;
    {34}event SMDP_SENT_AUTH(devS,tid,eChalS,serverNonce,ID_SMDP);
    {32}let CT_CLIENT: bitstring = kem_enc(PK_EUICC_KEM,r_client) in
    {29}let CT_EPH: bitstring = kem_enc(PK_EUICC_EPH,r_eph) in
    {35}out(LPA2SMDP, (devS,tid,CT_EPH,CT_CLIENT,serverNonce,CERT_SMDP));
    {36}in(LPA2SMDP, (devS2: Id_t,tid2: Tid_t,CT_SERVER: bitstring,Finished_EU_in: bitstring));
    {37}if (devS2 = dev) then
    {38}if (tid2 = tid) then
    {39}let SS_SERVER: KEMss_t = kem_dec(CT_SERVER,SK_SMDP_KEM) in
    {43}let transcript: bitstring = transcript_hash(eChalS,serverNonce,CT_EPH,CT_CLIENT,CT_SERVER,CERT_EUICC,CERT_SMDP) in
    {33}let SS_CLIENT: KEMss_t = kem_ss(PK_EUICC_KEM,r_client) in
    {30}let SS_EPH: KEMss_t = kem_ss(PK_EUICC_EPH,r_eph) in
    {40}let session_key: SessionKey_t = kemtls_kdf(SS_EPH,SS_SERVER,SS_CLIENT,eChalS,serverNonce,CT_EPH,CT_CLIENT,CT_SERVER,CERT_EUICC,CERT_SMDP,ID_EUICC,ID_SMDP) in
    {42}let KM: KM_t = get_KM(session_key) in
    {44}if (Finished_EU_in = kem_mac(KM,transcript)) then
    {45}event SMDP_VERIFIED_FINISHED(dev,tid,transcript);
    {46}event SMDP_KEY(devS,tid,session_key);
    {48}event SMDP_SENT_FINISHED(dev,tid,transcript);
    {47}let Finished_DP: bitstring = kem_mac(KM,(transcript,Finished_EU_in)) in
    {49}out(LPA2SMDP, (devS,tid,Finished_DP));
    {50}event SMDP_AUTH_OK(dev,tid,serverNonce,ID_EUICC)
) | (
    {51}!
    {52}let dev_1: Id_t = devMain in
    {53}out(LPA2EUICC, (t_getChal,ID_LPA,dev_1));
    {54}in(LPA2EUICC, (dev_ch: Id_t,eChal: Nonce_t,PK_EPH: KEMpk_t,CERT_EU: Cert_t));
    {55}if (dev_ch = dev_1) then
    {56}out(LPA2SMDP, (dev_1,eChal,PK_EPH,CERT_EU));
    {57}in(LPA2SMDP, (dev2: Id_t,tid_1: Tid_t,CT_EPH_1: bitstring,CT_CLIENT_1: bitstring,serverNonce_1: Nonce_t,CERT_DP: Cert_t));
    {58}if (dev2 = dev_1) then
    {59}out(LPA2EUICC, (dev_1,tid_1,CT_EPH_1,CT_CLIENT_1,serverNonce_1,CERT_DP));
    {60}in(LPA2EUICC, (dev3: Id_t,tid2_1: Tid_t,CT_SERVER_1: bitstring,Finished_EU: bitstring));
    {61}if (dev3 = dev_1) then
    {62}out(LPA2SMDP, (dev_1,tid2_1,CT_SERVER_1,Finished_EU));
    {63}in(LPA2SMDP, (dev4: Id_t,tid3: Tid_t,Finished_DP_1: bitstring));
    {64}if (dev4 = dev_1) then
    {65}out(LPA2EUICC, (dev_1,tid3,Finished_DP_1))
) | (
    {66}!
    {68}new SK_EUICC_KEM: KEMsk_t;
    {71}let role_2: Tag_t = tag_eu in
    {70}let id_2: Id_t = ID_EUICC in
    {69}let PK_EUICC_KEM_1: KEMpk_t = kem_pk(SK_EUICC_KEM) in
    {72}let cert_tbs_2: bitstring = (id_2,PK_EUICC_KEM_1,role_2) in
    {73}let sig_2: PQSig_t = pq_sign(cert_tbs_2,SK_ROOT_CA) in
    {74}let CERT_EUICC_1: Cert_t = make_cert(id_2,PK_EUICC_KEM_1,role_2,sig_2) in
    {75}out(c, CERT_EUICC_1);
    {76}new SK_EUICC_EPH: KEMsk_t;
    {78}in(LPA2EUICC, (=t_getChal,=ID_LPA,dev_in: Id_t));
    {67}let dev_2: Id_t = devMain in
    {79}if (dev_in = dev_2) then
    {80}new eChal_1: Nonce_t;
    {77}let PK_EUICC_EPH_1: KEMpk_t = kem_pk(SK_EUICC_EPH) in
    {81}out(LPA2EUICC, (dev_2,eChal_1,PK_EUICC_EPH_1,CERT_EUICC_1));
    {82}in(LPA2EUICC, (dev_in2: Id_t,tid_2: Tid_t,CT_EPH_2: bitstring,CT_CLIENT_2: bitstring,serverNonce_2: Nonce_t,CERT_SMDP_1: Cert_t));
    {83}if (dev_in2 = dev_2) then
    {84}let id_3: Id_t = catch-fail(get_cert_id(CERT_SMDP_1)) in
    {85}let v_4: bool = not-caught-fail(id_3) in
    {86}let kempk_1: KEMpk_t = (if v_4 then catch-fail(get_cert_kempk(CERT_SMDP_1)) else caught-fail) in
    {87}let v_5: bool = not-caught-fail(kempk_1) in
    {88}let role_3: Tag_t = (if v_5 then catch-fail(get_cert_role(CERT_SMDP_1)) else caught-fail) in
    {89}let v_6: bool = not-caught-fail(role_3) in
    {90}let sig_3: PQSig_t = (if v_6 then catch-fail(get_cert_sig(CERT_SMDP_1)) else caught-fail) in
    {91}let v_7: bool = not-caught-fail(sig_3) in
    {92}let cert_tbs_3: bitstring = (if v_7 then (id_3,kempk_1,role_3) else caught-fail) in
    {93}let (=ID_SMDP,PK_SMDP_KEM_1: KEMpk_t,=tag_dp) = (if v_4 then (if v_5 then (if v_6 then (if v_7 then (if (pq_verify(sig_3,cert_tbs_3,PK_ROOT) = true) then (id_3,kempk_1,role_3) else (ID_LPA,kempk_1,role_3)) else fail-any_type) else fail-any_type) else fail-any_type) else fail-any_type) in
    {94}let SS_EPH_1: KEMss_t = kem_dec(CT_EPH_2,SK_EUICC_EPH) in
    {95}let SS_CLIENT_1: KEMss_t = kem_dec(CT_CLIENT_2,SK_EUICC_KEM) in
    {96}new r_server: KEMcoin_t;
    {97}let CT_SERVER_2: bitstring = kem_enc(PK_SMDP_KEM_1,r_server) in
    {102}let transcript_1: bitstring = transcript_hash(eChal_1,serverNonce_2,CT_EPH_2,CT_CLIENT_2,CT_SERVER_2,CERT_EUICC_1,CERT_SMDP_1) in
    {104}event EUICC_SENT_FINISHED(dev_2,tid_2,transcript_1);
    {98}let SS_SERVER_1: KEMss_t = kem_ss(PK_SMDP_KEM_1,r_server) in
    {99}let session_key_1: SessionKey_t = kemtls_kdf(SS_EPH_1,SS_SERVER_1,SS_CLIENT_1,eChal_1,serverNonce_2,CT_EPH_2,CT_CLIENT_2,CT_SERVER_2,CERT_EUICC_1,CERT_SMDP_1,ID_EUICC,ID_SMDP) in
    {105}event EUICC_KEY(dev_2,tid_2,session_key_1);
    {106}out(c, senc_test(secret_payload,session_key_1));
    {101}let KM_1: KM_t = get_KM(session_key_1) in
    {103}let Finished_EU_1: bitstring = kem_mac(KM_1,transcript_1) in
    {107}out(LPA2EUICC, (dev_2,tid_2,CT_SERVER_2,Finished_EU_1));
    {108}in(LPA2EUICC, (dev_in3: Id_t,tid3_1: Tid_t,Finished_DP_in: bitstring));
    {109}if (dev_in3 = dev_2) then
    {110}if (tid3_1 = tid_2) then
    {111}if (Finished_DP_in = kem_mac(KM_1,(transcript_1,Finished_EU_1))) then
    {112}event EUICC_VERIFIED_FINISHED(dev_2,tid_2,transcript_1);
    {113}event EUICC_AUTH_OK(dev_2,tid_2,eChal_1,serverNonce_2,ID_SMDP)
) | (
    {114}phase 1;
    {115}out(c, SK_SMDP_KEM)
)

-- Query inj-event(EUICC_AUTH_OK(dev_3,tid_3,e,s,ID_SMDP)) ==> inj-event(SMDP_SENT_AUTH(dev_3,tid_3,e,s,ID_SMDP)) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 165 rules (81 with conclusion selected). Queue: 7 rules.
Starting query inj-event(EUICC_AUTH_OK(dev_3,tid_3,e,s,ID_SMDP)) ==> inj-event(SMDP_SENT_AUTH(dev_3,tid_3,e,s,ID_SMDP))
goal reachable: b-event(@p_act(@occ36_1,(devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))))) && attacker(tid_4) && b-inj-event(SMDP_SENT_AUTH(devMain[],tid_3,eChal_2,serverNonce_3,ID_SMDP),@occ34_1) -> inj-event(EUICC_AUTH_OK(devMain[],tid_4,eChal_2,serverNonce_3,ID_SMDP),@occ113_1)
Abbreviations:
eChal_2 = eChal_1[dev_in = devMain[],!1 = @sid]
SK_EUICC_KEM_1 = SK_EUICC_KEM[!1 = @sid]
SK_EUICC_EPH_1 = SK_EUICC_EPH[!1 = @sid]
serverNonce_3 = serverNonce[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_eph_1 = r_eph[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_client_1 = r_client[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_server_1 = r_server[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_4,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
@occ113_1 = @occ113[Finished_DP_in = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))),tid3_1 = tid_4,dev_in3 = devMain[],CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_4,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
@occ36_1 = @occ36[!1 = @sid_1]
tid_3 = tid[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
@occ34_1 = @occ34[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]

Derivation:
Abbreviations:
eChal_2 = eChal_1[dev_in = devMain[],!1 = @sid]
SK_EUICC_KEM_1 = SK_EUICC_KEM[!1 = @sid]
SK_EUICC_EPH_1 = SK_EUICC_EPH[!1 = @sid]
serverNonce_3 = serverNonce[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_eph_1 = r_eph[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_client_1 = r_client[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_server_1 = r_server[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_3,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
@occ113_1 = @occ113[Finished_DP_in = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))),tid3_1 = tid_3,dev_in3 = devMain[],CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_3,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
tid_4 = tid[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
@occ36_1 = @occ36[!1 = @sid_1]
@occ34_1 = @occ34[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]

1. The message (t_getChal,ID_LPA,devMain[]) may be sent to the attacker at output {53}.
attacker((t_getChal,ID_LPA,devMain[])).

2. By 1, the attacker may know (t_getChal,ID_LPA,devMain[]).
Using the function 3-proj-3-tuple the attacker may obtain devMain[].
attacker(devMain[]).

3. Using the function ID_LPA the attacker may obtain ID_LPA.
attacker(ID_LPA).

4. Using the function t_getChal the attacker may obtain t_getChal.
attacker(t_getChal).

5. By 4, the attacker may know t_getChal.
By 3, the attacker may know ID_LPA.
By 2, the attacker may know devMain[].
Using the function 3-tuple the attacker may obtain (t_getChal,ID_LPA,devMain[]).
attacker((t_getChal,ID_LPA,devMain[])).

6. The message make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) may be sent to the attacker at output {12}.
attacker(make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).

7. The message make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)) may be sent to the attacker at output {75}.
attacker(make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).

8. The message (t_getChal,ID_LPA,devMain[]) that the attacker may have by 5 may be received at input {78}.
So the message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) may be sent to the attacker at output {81}.
attacker((devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)))).

9. By 8, the attacker may know (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
Using the function 3-proj-4-tuple the attacker may obtain kem_pk(SK_EUICC_EPH_1).
attacker(kem_pk(SK_EUICC_EPH_1)).

10. By 8, the attacker may know (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
Using the function 2-proj-4-tuple the attacker may obtain eChal_2.
attacker(eChal_2).

11. By 2, the attacker may know devMain[].
By 10, the attacker may know eChal_2.
By 9, the attacker may know kem_pk(SK_EUICC_EPH_1).
By 7, the attacker may know make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)).
Using the function 4-tuple the attacker may obtain (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
attacker((devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)))).

12. The message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) that the attacker may have by 11 may be received at input {13}.
The event SMDP_SENT_AUTH(devMain[],tid_4,eChal_2,serverNonce_3,ID_SMDP) (with occurrence name @occ34_1) may be executed at {34}.
So the message (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))) may be sent to the attacker at output {35}.
attacker((devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).

13. By 12, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 5-proj-6-tuple the attacker may obtain serverNonce_3.
attacker(serverNonce_3).

14. By 12, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 4-proj-6-tuple the attacker may obtain kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
attacker(kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1)).

15. By 14, the attacker may know kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
Using the function 2-proj-kem_enc the attacker may obtain r_client_1.
attacker(r_client_1).

16. By 7, the attacker may know make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)).
Using the function get_cert_kempk the attacker may obtain kem_pk(SK_EUICC_KEM_1).
attacker(kem_pk(SK_EUICC_KEM_1)).

17. By 16, the attacker may know kem_pk(SK_EUICC_KEM_1).
By 15, the attacker may know r_client_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
attacker(kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1)).

18. By 12, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 3-proj-6-tuple the attacker may obtain kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
attacker(kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1)).

19. By 18, the attacker may know kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
Using the function 2-proj-kem_enc the attacker may obtain r_eph_1.
attacker(r_eph_1).

20. By 9, the attacker may know kem_pk(SK_EUICC_EPH_1).
By 19, the attacker may know r_eph_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
attacker(kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1)).

21. We assume as hypothesis that
attacker(tid_3).

22. By 2, the attacker may know devMain[].
By 21, the attacker may know tid_3.
By 20, the attacker may know kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
By 17, the attacker may know kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
By 13, the attacker may know serverNonce_3.
By 6, the attacker may know make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)).
Using the function 6-tuple the attacker may obtain (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
attacker((devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).

23. The message (t_getChal,ID_LPA,devMain[]) that the attacker may have by 5 may be received at input {78}.
The message (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))) that the attacker may have by 22 may be received at input {82}.
So the message (devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))) may be sent to the attacker at output {107}.
attacker((devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).

24. By 23, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
Using the function 4-proj-4-tuple the attacker may obtain kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).
attacker(kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).

25. By 23, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
Using the function 3-proj-4-tuple the attacker may obtain kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
attacker(kem_enc(kem_pk(SK_SMDP_KEM),r_server_1)).

26. By 25, the attacker may know kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
Using the function 2-proj-kem_enc the attacker may obtain r_server_1.
attacker(r_server_1).

27. By 6, the attacker may know make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)).
Using the function get_cert_kempk the attacker may obtain kem_pk(SK_SMDP_KEM).
attacker(kem_pk(SK_SMDP_KEM)).

28. By 27, the attacker may know kem_pk(SK_SMDP_KEM).
By 26, the attacker may know r_server_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
attacker(kem_enc(kem_pk(SK_SMDP_KEM),r_server_1)).

29. By 12, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 2-proj-6-tuple the attacker may obtain tid_4.
attacker(tid_4).

30. By 2, the attacker may know devMain[].
By 29, the attacker may know tid_4.
By 28, the attacker may know kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
By 24, the attacker may know kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).
Using the function 4-tuple the attacker may obtain (devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
attacker((devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).

31. The message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) that the attacker may have by 11 may be received at input {13}.
The event SMDP_SENT_AUTH(devMain[],tid_4,eChal_2,serverNonce_3,ID_SMDP) (with occurrence name @occ34_1) may be executed at {34}.
The event @p_act(@occ36_1,(devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))) records how variables are instantiated at {36}.
The message (devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))) that the attacker may have by 30 may be received at input {36}.
So the message (devMain[],tid_4,kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))))) may be sent to the attacker at output {49}.
attacker((devMain[],tid_4,kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))))).

32. By 31, the attacker may know (devMain[],tid_4,kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))))).
Using the function 3-proj-3-tuple the attacker may obtain kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).
attacker(kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))))).

33. By 2, the attacker may know devMain[].
By 21, the attacker may know tid_3.
By 32, the attacker may know kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).
Using the function 3-tuple the attacker may obtain (devMain[],tid_3,kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))))).
attacker((devMain[],tid_3,kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))))).

34. The message (t_getChal,ID_LPA,devMain[]) that the attacker may have by 5 may be received at input {78}.
The message (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))) that the attacker may have by 22 may be received at input {82}.
The message (devMain[],tid_3,kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))))) that the attacker may have by 33 may be received at input {108}.
So event EUICC_AUTH_OK(devMain[],tid_3,eChal_2,serverNonce_3,ID_SMDP) may be executed at {113} in session @sid.
inj-event(EUICC_AUTH_OK(devMain[],tid_3,eChal_2,serverNonce_3,ID_SMDP),@occ113_1).

35. By 34, inj-event(EUICC_AUTH_OK(devMain[],tid_3,eChal_2,serverNonce_3,ID_SMDP),@occ113_1).
The goal is reached, represented in the following fact:
inj-event(EUICC_AUTH_OK(devMain[],tid_3,eChal_2,serverNonce_3,ID_SMDP),@occ113_1).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, ~M) with ~M = pq_sig_pk(SK_ROOT_CA) at {2}

new devMain: Id_t creating devMain_1 at {3}

new SK_EUICC_KEM: KEMsk_t creating SK_EUICC_KEM_2 at {68} in copy a

out(c, ~M_1) with ~M_1 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {75} in copy a

new SK_EUICC_EPH: KEMsk_t creating SK_EUICC_EPH_2 at {76} in copy a

out(LPA2EUICC, (~M_2,~M_3,~M_4)) with ~M_2 = t_getChal, ~M_3 = ID_LPA, ~M_4 = devMain_1 at {53} in copy a_1

out(c, ~M_5) with ~M_5 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {12} in copy a_2

out(c, ~M_6) with ~M_6 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {12} in copy a_3

in(LPA2EUICC, (t_getChal,ID_LPA,~M_4)) with ~M_4 = devMain_1 at {78} in copy a

new eChal_1: Nonce_t creating eChal_3 at {80} in copy a

out(LPA2EUICC, (~M_7,~M_8,~M_9,~M_10)) with ~M_7 = devMain_1, ~M_8 = eChal_3, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_10 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {81} in copy a

in(LPA2SMDP, (~M_4,~M_8,~M_9,~M_1)) with ~M_4 = devMain_1, ~M_8 = eChal_3, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_1 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {13} in copy a_3

new tid: Tid_t creating tid_5 at {25} in copy a_3

new serverNonce: Nonce_t creating serverNonce_4 at {26} in copy a_3

event SMDP_BEGIN(devMain_1,tid_5,eChal_3,serverNonce_4) at {27} in copy a_3

new r_eph: KEMcoin_t creating r_eph_2 at {28} in copy a_3

new r_client: KEMcoin_t creating r_client_2 at {31} in copy a_3

event SMDP_SENT_AUTH(devMain_1,tid_5,eChal_3,serverNonce_4,ID_SMDP) at {34} in copy a_3

out(LPA2SMDP, (~M_11,~M_12,kem_enc(~M_13,~M_14),kem_enc(~M_15,~M_16),~M_17,~M_18)) with ~M_11 = devMain_1, ~M_12 = tid_5, ~M_13 = kem_pk(SK_EUICC_EPH_2), ~M_14 = r_eph_2, ~M_15 = kem_pk(SK_EUICC_KEM_2), ~M_16 = r_client_2, ~M_17 = serverNonce_4, ~M_18 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {35} in copy a_3

in(LPA2EUICC, (~M_4,a_4,kem_enc(~M_9,~M_14),kem_enc(get_cert_kempk(~M_1),~M_16),~M_17,~M_5)) with ~M_4 = devMain_1, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_14 = r_eph_2, get_cert_kempk(~M_1) = kem_pk(SK_EUICC_KEM_2), ~M_16 = r_client_2, ~M_17 = serverNonce_4, ~M_5 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {82} in copy a

new r_server: KEMcoin_t creating r_server_2 at {96} in copy a

event EUICC_SENT_FINISHED(devMain_1,a_4,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {104} in copy a

event EUICC_KEY(devMain_1,a_4,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {105} in copy a

out(c, ~M_19) with ~M_19 = senc_test(secret_payload,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {106} in copy a

out(LPA2EUICC, (~M_20,~M_21,kem_enc(~M_22,~M_23),~M_24)) with ~M_20 = devMain_1, ~M_21 = a_4, ~M_22 = kem_pk(SK_SMDP_KEM), ~M_23 = r_server_2, ~M_24 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {107} in copy a

in(LPA2SMDP, (~M_4,~M_12,kem_enc(get_cert_kempk(~M_5),~M_23),~M_24)) with ~M_4 = devMain_1, ~M_12 = tid_5, get_cert_kempk(~M_5) = kem_pk(SK_SMDP_KEM), ~M_23 = r_server_2, ~M_24 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {36} in copy a_3

event SMDP_VERIFIED_FINISHED(devMain_1,tid_5,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {45} in copy a_3

event SMDP_KEY(devMain_1,tid_5,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {46} in copy a_3

event SMDP_SENT_FINISHED(devMain_1,tid_5,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {48} in copy a_3

out(LPA2SMDP, (~M_25,~M_26,~M_27)) with ~M_25 = devMain_1, ~M_26 = tid_5, ~M_27 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))) at {49} in copy a_3

event SMDP_AUTH_OK(devMain_1,tid_5,serverNonce_4,ID_EUICC) at {50} in copy a_3

in(LPA2EUICC, (~M_4,a_4,~M_27)) with ~M_4 = devMain_1, ~M_27 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))) at {108} in copy a

event EUICC_VERIFIED_FINISHED(devMain_1,a_4,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {112} in copy a

event EUICC_AUTH_OK(devMain_1,a_4,eChal_3,serverNonce_4,ID_SMDP) at {113} in copy a (goal)

The event EUICC_AUTH_OK(devMain_1,a_4,eChal_3,serverNonce_4,ID_SMDP) is executed at {113} in copy a.
A trace has been found.
RESULT inj-event(EUICC_AUTH_OK(dev_3,tid_3,e,s,ID_SMDP)) ==> inj-event(SMDP_SENT_AUTH(dev_3,tid_3,e,s,ID_SMDP)) is false.
RESULT (even event(EUICC_AUTH_OK(dev_3,tid_3,e,s,ID_SMDP)) ==> event(SMDP_SENT_AUTH(dev_3,tid_3,e,s,ID_SMDP)) is false.)
-- Query inj-event(SMDP_AUTH_OK(dev_3,tid_3,s,ID_EUICC)) ==> inj-event(EUICC_SENT_FINISHED(dev_3,tid_3,transcript_2)) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 165 rules (80 with conclusion selected). Queue: 8 rules.
Starting query inj-event(SMDP_AUTH_OK(dev_3,tid_3,s,ID_EUICC)) ==> inj-event(EUICC_SENT_FINISHED(dev_3,tid_3,transcript_2))
goal reachable: b-inj-event(EUICC_SENT_FINISHED(devMain[],tid_3,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),@occ104_1) && attacker(tid_3) -> inj-event(SMDP_AUTH_OK(devMain[],tid_4,serverNonce_3,ID_EUICC),@occ50_1)
Abbreviations:
SK_EUICC_KEM_1 = SK_EUICC_KEM[!1 = @sid]
SK_EUICC_EPH_1 = SK_EUICC_EPH[!1 = @sid]
eChal_2 = eChal_1[dev_in = devMain[],!1 = @sid]
tid_4 = tid[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
serverNonce_3 = serverNonce[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_eph_1 = r_eph[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_client_1 = r_client[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_server_1 = r_server[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_3,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
@occ50_1 = @occ50[Finished_EU_in = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),CT_SERVER = kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),tid2 = tid_4,devS2 = devMain[],CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
@occ104_1 = @occ104[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_3,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]

Derivation:
Abbreviations:
SK_EUICC_KEM_1 = SK_EUICC_KEM[!1 = @sid]
SK_EUICC_EPH_1 = SK_EUICC_EPH[!1 = @sid]
eChal_2 = eChal_1[dev_in = devMain[],!1 = @sid]
tid_3 = tid[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
serverNonce_3 = serverNonce[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_eph_1 = r_eph[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_client_1 = r_client[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_server_1 = r_server[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_4,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
@occ50_1 = @occ50[Finished_EU_in = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),CT_SERVER = kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),tid2 = tid_3,devS2 = devMain[],CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
@occ104_1 = @occ104[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_4,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]

1. The message make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)) may be sent to the attacker at output {75}.
attacker(make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).

2. The message (t_getChal,ID_LPA,devMain[]) may be sent to the attacker at output {53}.
attacker((t_getChal,ID_LPA,devMain[])).

3. By 2, the attacker may know (t_getChal,ID_LPA,devMain[]).
Using the function 3-proj-3-tuple the attacker may obtain devMain[].
attacker(devMain[]).

4. Using the function ID_LPA the attacker may obtain ID_LPA.
attacker(ID_LPA).

5. Using the function t_getChal the attacker may obtain t_getChal.
attacker(t_getChal).

6. By 5, the attacker may know t_getChal.
By 4, the attacker may know ID_LPA.
By 3, the attacker may know devMain[].
Using the function 3-tuple the attacker may obtain (t_getChal,ID_LPA,devMain[]).
attacker((t_getChal,ID_LPA,devMain[])).

7. The message (t_getChal,ID_LPA,devMain[]) that the attacker may have by 6 may be received at input {78}.
So the message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) may be sent to the attacker at output {81}.
attacker((devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)))).

8. By 7, the attacker may know (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
Using the function 3-proj-4-tuple the attacker may obtain kem_pk(SK_EUICC_EPH_1).
attacker(kem_pk(SK_EUICC_EPH_1)).

9. By 7, the attacker may know (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
Using the function 2-proj-4-tuple the attacker may obtain eChal_2.
attacker(eChal_2).

10. By 3, the attacker may know devMain[].
By 9, the attacker may know eChal_2.
By 8, the attacker may know kem_pk(SK_EUICC_EPH_1).
By 1, the attacker may know make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)).
Using the function 4-tuple the attacker may obtain (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
attacker((devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)))).

11. The message make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) may be sent to the attacker at output {12}.
attacker(make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).

12. The message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) that the attacker may have by 10 may be received at input {13}.
So the message (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))) may be sent to the attacker at output {35}.
attacker((devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).

13. By 12, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 5-proj-6-tuple the attacker may obtain serverNonce_3.
attacker(serverNonce_3).

14. By 12, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 4-proj-6-tuple the attacker may obtain kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
attacker(kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1)).

15. By 14, the attacker may know kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
Using the function 2-proj-kem_enc the attacker may obtain r_client_1.
attacker(r_client_1).

16. By 1, the attacker may know make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)).
Using the function get_cert_kempk the attacker may obtain kem_pk(SK_EUICC_KEM_1).
attacker(kem_pk(SK_EUICC_KEM_1)).

17. By 16, the attacker may know kem_pk(SK_EUICC_KEM_1).
By 15, the attacker may know r_client_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
attacker(kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1)).

18. By 12, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 3-proj-6-tuple the attacker may obtain kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
attacker(kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1)).

19. By 18, the attacker may know kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
Using the function 2-proj-kem_enc the attacker may obtain r_eph_1.
attacker(r_eph_1).

20. By 8, the attacker may know kem_pk(SK_EUICC_EPH_1).
By 19, the attacker may know r_eph_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
attacker(kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1)).

21. We assume as hypothesis that
attacker(tid_4).

22. By 3, the attacker may know devMain[].
By 21, the attacker may know tid_4.
By 20, the attacker may know kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
By 17, the attacker may know kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
By 13, the attacker may know serverNonce_3.
By 11, the attacker may know make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)).
Using the function 6-tuple the attacker may obtain (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
attacker((devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).

23. The message (t_getChal,ID_LPA,devMain[]) that the attacker may have by 6 may be received at input {78}.
The message (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))) that the attacker may have by 22 may be received at input {82}.
The event EUICC_SENT_FINISHED(devMain[],tid_4,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) (with occurrence name @occ104_1) may be executed at {104}.
So the message (devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))) may be sent to the attacker at output {107}.
attacker((devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).

24. By 23, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
Using the function 4-proj-4-tuple the attacker may obtain kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).
attacker(kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).

25. By 23, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
Using the function 3-proj-4-tuple the attacker may obtain kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
attacker(kem_enc(kem_pk(SK_SMDP_KEM),r_server_1)).

26. By 25, the attacker may know kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
Using the function 2-proj-kem_enc the attacker may obtain r_server_1.
attacker(r_server_1).

27. By 11, the attacker may know make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)).
Using the function get_cert_kempk the attacker may obtain kem_pk(SK_SMDP_KEM).
attacker(kem_pk(SK_SMDP_KEM)).

28. By 27, the attacker may know kem_pk(SK_SMDP_KEM).
By 26, the attacker may know r_server_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
attacker(kem_enc(kem_pk(SK_SMDP_KEM),r_server_1)).

29. By 12, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 2-proj-6-tuple the attacker may obtain tid_3.
attacker(tid_3).

30. By 3, the attacker may know devMain[].
By 29, the attacker may know tid_3.
By 28, the attacker may know kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
By 24, the attacker may know kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).
Using the function 4-tuple the attacker may obtain (devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
attacker((devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).

31. The message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) that the attacker may have by 10 may be received at input {13}.
The message (devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))) that the attacker may have by 30 may be received at input {36}.
So event SMDP_AUTH_OK(devMain[],tid_3,serverNonce_3,ID_EUICC) may be executed at {50} in session @sid_1.
inj-event(SMDP_AUTH_OK(devMain[],tid_3,serverNonce_3,ID_EUICC),@occ50_1).

32. By 31, inj-event(SMDP_AUTH_OK(devMain[],tid_3,serverNonce_3,ID_EUICC),@occ50_1).
The goal is reached, represented in the following fact:
inj-event(SMDP_AUTH_OK(devMain[],tid_3,serverNonce_3,ID_EUICC),@occ50_1).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, ~M) with ~M = pq_sig_pk(SK_ROOT_CA) at {2}

new devMain: Id_t creating devMain_1 at {3}

new SK_EUICC_KEM: KEMsk_t creating SK_EUICC_KEM_2 at {68} in copy a

out(c, ~M_1) with ~M_1 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {75} in copy a

new SK_EUICC_EPH: KEMsk_t creating SK_EUICC_EPH_2 at {76} in copy a

out(LPA2EUICC, (~M_2,~M_3,~M_4)) with ~M_2 = t_getChal, ~M_3 = ID_LPA, ~M_4 = devMain_1 at {53} in copy a_1

out(c, ~M_5) with ~M_5 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {12} in copy a_2

out(c, ~M_6) with ~M_6 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {12} in copy a_3

in(LPA2EUICC, (t_getChal,ID_LPA,~M_4)) with ~M_4 = devMain_1 at {78} in copy a

new eChal_1: Nonce_t creating eChal_3 at {80} in copy a

out(LPA2EUICC, (~M_7,~M_8,~M_9,~M_10)) with ~M_7 = devMain_1, ~M_8 = eChal_3, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_10 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {81} in copy a

in(LPA2SMDP, (~M_4,~M_8,~M_9,~M_1)) with ~M_4 = devMain_1, ~M_8 = eChal_3, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_1 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {13} in copy a_2

new tid: Tid_t creating tid_5 at {25} in copy a_2

new serverNonce: Nonce_t creating serverNonce_4 at {26} in copy a_2

event SMDP_BEGIN(devMain_1,tid_5,eChal_3,serverNonce_4) at {27} in copy a_2

new r_eph: KEMcoin_t creating r_eph_2 at {28} in copy a_2

new r_client: KEMcoin_t creating r_client_2 at {31} in copy a_2

event SMDP_SENT_AUTH(devMain_1,tid_5,eChal_3,serverNonce_4,ID_SMDP) at {34} in copy a_2

out(LPA2SMDP, (~M_11,~M_12,kem_enc(~M_13,~M_14),kem_enc(~M_15,~M_16),~M_17,~M_18)) with ~M_11 = devMain_1, ~M_12 = tid_5, ~M_13 = kem_pk(SK_EUICC_EPH_2), ~M_14 = r_eph_2, ~M_15 = kem_pk(SK_EUICC_KEM_2), ~M_16 = r_client_2, ~M_17 = serverNonce_4, ~M_18 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {35} in copy a_2

in(LPA2EUICC, (~M_4,a_4,kem_enc(~M_9,~M_14),kem_enc(get_cert_kempk(~M_1),~M_16),~M_17,~M_5)) with ~M_4 = devMain_1, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_14 = r_eph_2, get_cert_kempk(~M_1) = kem_pk(SK_EUICC_KEM_2), ~M_16 = r_client_2, ~M_17 = serverNonce_4, ~M_5 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {82} in copy a

new r_server: KEMcoin_t creating r_server_2 at {96} in copy a

event EUICC_SENT_FINISHED(devMain_1,a_4,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {104} in copy a

event EUICC_KEY(devMain_1,a_4,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {105} in copy a

out(c, ~M_19) with ~M_19 = senc_test(secret_payload,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {106} in copy a

out(LPA2EUICC, (~M_20,~M_21,kem_enc(~M_22,~M_23),~M_24)) with ~M_20 = devMain_1, ~M_21 = a_4, ~M_22 = kem_pk(SK_SMDP_KEM), ~M_23 = r_server_2, ~M_24 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {107} in copy a

in(LPA2SMDP, (~M_4,~M_12,kem_enc(get_cert_kempk(~M_5),~M_23),~M_24)) with ~M_4 = devMain_1, ~M_12 = tid_5, get_cert_kempk(~M_5) = kem_pk(SK_SMDP_KEM), ~M_23 = r_server_2, ~M_24 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {36} in copy a_2

event SMDP_VERIFIED_FINISHED(devMain_1,tid_5,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {45} in copy a_2

event SMDP_KEY(devMain_1,tid_5,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {46} in copy a_2

event SMDP_SENT_FINISHED(devMain_1,tid_5,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {48} in copy a_2

out(LPA2SMDP, (~M_25,~M_26,~M_27)) with ~M_25 = devMain_1, ~M_26 = tid_5, ~M_27 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))) at {49} in copy a_2

event SMDP_AUTH_OK(devMain_1,tid_5,serverNonce_4,ID_EUICC) at {50} in copy a_2 (goal)

The event SMDP_AUTH_OK(devMain_1,tid_5,serverNonce_4,ID_EUICC) is executed at {50} in copy a_2.
A trace has been found.
RESULT inj-event(SMDP_AUTH_OK(dev_3,tid_3,s,ID_EUICC)) ==> inj-event(EUICC_SENT_FINISHED(dev_3,tid_3,transcript_2)) is false.
RESULT (even event(SMDP_AUTH_OK(dev_3,tid_3,s,ID_EUICC)) ==> event(EUICC_SENT_FINISHED(dev_3,tid_3,transcript_2)) is false.)
-- Query inj-event(SMDP_KEY(dev_3,tid_3,k)) ==> inj-event(EUICC_KEY(dev_3,tid_3,k)) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 165 rules (80 with conclusion selected). Queue: 8 rules.
Starting query inj-event(SMDP_KEY(dev_3,tid_3,k)) ==> inj-event(EUICC_KEY(dev_3,tid_3,k))
goal reachable: b-inj-event(EUICC_KEY(devMain[],tid_3,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),@occ105_1) && attacker(tid_3) -> inj-event(SMDP_KEY(devMain[],tid_4,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),@occ46_1)
Abbreviations:
SK_EUICC_KEM_1 = SK_EUICC_KEM[!1 = @sid]
SK_EUICC_EPH_1 = SK_EUICC_EPH[!1 = @sid]
eChal_2 = eChal_1[dev_in = devMain[],!1 = @sid]
tid_4 = tid[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_eph_1 = r_eph[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
serverNonce_3 = serverNonce[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_client_1 = r_client[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_server_1 = r_server[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_3,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
@occ46_1 = @occ46[Finished_EU_in = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),CT_SERVER = kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),tid2 = tid_4,devS2 = devMain[],CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
@occ105_1 = @occ105[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_3,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]

Derivation:
Abbreviations:
SK_EUICC_KEM_1 = SK_EUICC_KEM[!1 = @sid]
SK_EUICC_EPH_1 = SK_EUICC_EPH[!1 = @sid]
eChal_2 = eChal_1[dev_in = devMain[],!1 = @sid]
tid_3 = tid[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_eph_1 = r_eph[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
serverNonce_3 = serverNonce[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_client_1 = r_client[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_server_1 = r_server[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_4,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
@occ46_1 = @occ46[Finished_EU_in = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),CT_SERVER = kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),tid2 = tid_3,devS2 = devMain[],CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
@occ105_1 = @occ105[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_4,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]

1. The message make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)) may be sent to the attacker at output {75}.
attacker(make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).

2. The message (t_getChal,ID_LPA,devMain[]) may be sent to the attacker at output {53}.
attacker((t_getChal,ID_LPA,devMain[])).

3. By 2, the attacker may know (t_getChal,ID_LPA,devMain[]).
Using the function 3-proj-3-tuple the attacker may obtain devMain[].
attacker(devMain[]).

4. Using the function ID_LPA the attacker may obtain ID_LPA.
attacker(ID_LPA).

5. Using the function t_getChal the attacker may obtain t_getChal.
attacker(t_getChal).

6. By 5, the attacker may know t_getChal.
By 4, the attacker may know ID_LPA.
By 3, the attacker may know devMain[].
Using the function 3-tuple the attacker may obtain (t_getChal,ID_LPA,devMain[]).
attacker((t_getChal,ID_LPA,devMain[])).

7. The message (t_getChal,ID_LPA,devMain[]) that the attacker may have by 6 may be received at input {78}.
So the message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) may be sent to the attacker at output {81}.
attacker((devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)))).

8. By 7, the attacker may know (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
Using the function 3-proj-4-tuple the attacker may obtain kem_pk(SK_EUICC_EPH_1).
attacker(kem_pk(SK_EUICC_EPH_1)).

9. By 7, the attacker may know (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
Using the function 2-proj-4-tuple the attacker may obtain eChal_2.
attacker(eChal_2).

10. By 3, the attacker may know devMain[].
By 9, the attacker may know eChal_2.
By 8, the attacker may know kem_pk(SK_EUICC_EPH_1).
By 1, the attacker may know make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)).
Using the function 4-tuple the attacker may obtain (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
attacker((devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)))).

11. The message make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) may be sent to the attacker at output {12}.
attacker(make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).

12. The message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) that the attacker may have by 10 may be received at input {13}.
So the message (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))) may be sent to the attacker at output {35}.
attacker((devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).

13. By 12, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 5-proj-6-tuple the attacker may obtain serverNonce_3.
attacker(serverNonce_3).

14. By 12, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 4-proj-6-tuple the attacker may obtain kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
attacker(kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1)).

15. By 14, the attacker may know kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
Using the function 2-proj-kem_enc the attacker may obtain r_client_1.
attacker(r_client_1).

16. By 1, the attacker may know make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)).
Using the function get_cert_kempk the attacker may obtain kem_pk(SK_EUICC_KEM_1).
attacker(kem_pk(SK_EUICC_KEM_1)).

17. By 16, the attacker may know kem_pk(SK_EUICC_KEM_1).
By 15, the attacker may know r_client_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
attacker(kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1)).

18. By 12, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 3-proj-6-tuple the attacker may obtain kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
attacker(kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1)).

19. By 18, the attacker may know kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
Using the function 2-proj-kem_enc the attacker may obtain r_eph_1.
attacker(r_eph_1).

20. By 8, the attacker may know kem_pk(SK_EUICC_EPH_1).
By 19, the attacker may know r_eph_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
attacker(kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1)).

21. We assume as hypothesis that
attacker(tid_4).

22. By 3, the attacker may know devMain[].
By 21, the attacker may know tid_4.
By 20, the attacker may know kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
By 17, the attacker may know kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
By 13, the attacker may know serverNonce_3.
By 11, the attacker may know make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)).
Using the function 6-tuple the attacker may obtain (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
attacker((devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).

23. The message (t_getChal,ID_LPA,devMain[]) that the attacker may have by 6 may be received at input {78}.
The message (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))) that the attacker may have by 22 may be received at input {82}.
The event EUICC_KEY(devMain[],tid_4,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) (with occurrence name @occ105_1) may be executed at {105}.
So the message (devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))) may be sent to the attacker at output {107}.
attacker((devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).

24. By 23, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
Using the function 4-proj-4-tuple the attacker may obtain kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).
attacker(kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).

25. By 23, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
Using the function 3-proj-4-tuple the attacker may obtain kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
attacker(kem_enc(kem_pk(SK_SMDP_KEM),r_server_1)).

26. By 25, the attacker may know kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
Using the function 2-proj-kem_enc the attacker may obtain r_server_1.
attacker(r_server_1).

27. By 11, the attacker may know make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)).
Using the function get_cert_kempk the attacker may obtain kem_pk(SK_SMDP_KEM).
attacker(kem_pk(SK_SMDP_KEM)).

28. By 27, the attacker may know kem_pk(SK_SMDP_KEM).
By 26, the attacker may know r_server_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
attacker(kem_enc(kem_pk(SK_SMDP_KEM),r_server_1)).

29. By 12, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 2-proj-6-tuple the attacker may obtain tid_3.
attacker(tid_3).

30. By 3, the attacker may know devMain[].
By 29, the attacker may know tid_3.
By 28, the attacker may know kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
By 24, the attacker may know kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).
Using the function 4-tuple the attacker may obtain (devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
attacker((devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).

31. The message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) that the attacker may have by 10 may be received at input {13}.
The message (devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))) that the attacker may have by 30 may be received at input {36}.
So event SMDP_KEY(devMain[],tid_3,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) may be executed at {46} in session @sid_1.
inj-event(SMDP_KEY(devMain[],tid_3,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),@occ46_1).

32. By 31, inj-event(SMDP_KEY(devMain[],tid_3,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),@occ46_1).
The goal is reached, represented in the following fact:
inj-event(SMDP_KEY(devMain[],tid_3,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),@occ46_1).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, ~M) with ~M = pq_sig_pk(SK_ROOT_CA) at {2}

new devMain: Id_t creating devMain_1 at {3}

new SK_EUICC_KEM: KEMsk_t creating SK_EUICC_KEM_2 at {68} in copy a

out(c, ~M_1) with ~M_1 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {75} in copy a

new SK_EUICC_EPH: KEMsk_t creating SK_EUICC_EPH_2 at {76} in copy a

out(LPA2EUICC, (~M_2,~M_3,~M_4)) with ~M_2 = t_getChal, ~M_3 = ID_LPA, ~M_4 = devMain_1 at {53} in copy a_1

out(c, ~M_5) with ~M_5 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {12} in copy a_2

out(c, ~M_6) with ~M_6 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {12} in copy a_3

in(LPA2EUICC, (t_getChal,ID_LPA,~M_4)) with ~M_4 = devMain_1 at {78} in copy a

new eChal_1: Nonce_t creating eChal_3 at {80} in copy a

out(LPA2EUICC, (~M_7,~M_8,~M_9,~M_10)) with ~M_7 = devMain_1, ~M_8 = eChal_3, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_10 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {81} in copy a

in(LPA2SMDP, (~M_4,~M_8,~M_9,~M_1)) with ~M_4 = devMain_1, ~M_8 = eChal_3, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_1 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {13} in copy a_2

new tid: Tid_t creating tid_5 at {25} in copy a_2

new serverNonce: Nonce_t creating serverNonce_4 at {26} in copy a_2

event SMDP_BEGIN(devMain_1,tid_5,eChal_3,serverNonce_4) at {27} in copy a_2

new r_eph: KEMcoin_t creating r_eph_2 at {28} in copy a_2

new r_client: KEMcoin_t creating r_client_2 at {31} in copy a_2

event SMDP_SENT_AUTH(devMain_1,tid_5,eChal_3,serverNonce_4,ID_SMDP) at {34} in copy a_2

out(LPA2SMDP, (~M_11,~M_12,kem_enc(~M_13,~M_14),kem_enc(~M_15,~M_16),~M_17,~M_18)) with ~M_11 = devMain_1, ~M_12 = tid_5, ~M_13 = kem_pk(SK_EUICC_EPH_2), ~M_14 = r_eph_2, ~M_15 = kem_pk(SK_EUICC_KEM_2), ~M_16 = r_client_2, ~M_17 = serverNonce_4, ~M_18 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {35} in copy a_2

in(LPA2EUICC, (~M_4,a_4,kem_enc(~M_9,~M_14),kem_enc(get_cert_kempk(~M_1),~M_16),~M_17,~M_5)) with ~M_4 = devMain_1, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_14 = r_eph_2, get_cert_kempk(~M_1) = kem_pk(SK_EUICC_KEM_2), ~M_16 = r_client_2, ~M_17 = serverNonce_4, ~M_5 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {82} in copy a

new r_server: KEMcoin_t creating r_server_2 at {96} in copy a

event EUICC_SENT_FINISHED(devMain_1,a_4,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {104} in copy a

event EUICC_KEY(devMain_1,a_4,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {105} in copy a

out(c, ~M_19) with ~M_19 = senc_test(secret_payload,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {106} in copy a

out(LPA2EUICC, (~M_20,~M_21,kem_enc(~M_22,~M_23),~M_24)) with ~M_20 = devMain_1, ~M_21 = a_4, ~M_22 = kem_pk(SK_SMDP_KEM), ~M_23 = r_server_2, ~M_24 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {107} in copy a

in(LPA2SMDP, (~M_4,~M_12,kem_enc(get_cert_kempk(~M_5),~M_23),~M_24)) with ~M_4 = devMain_1, ~M_12 = tid_5, get_cert_kempk(~M_5) = kem_pk(SK_SMDP_KEM), ~M_23 = r_server_2, ~M_24 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {36} in copy a_2

event SMDP_VERIFIED_FINISHED(devMain_1,tid_5,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {45} in copy a_2

event SMDP_KEY(devMain_1,tid_5,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {46} in copy a_2 (goal)

The event SMDP_KEY(devMain_1,tid_5,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) is executed at {46} in copy a_2.
A trace has been found.
RESULT inj-event(SMDP_KEY(dev_3,tid_3,k)) ==> inj-event(EUICC_KEY(dev_3,tid_3,k)) is false.
RESULT (even event(SMDP_KEY(dev_3,tid_3,k)) ==> event(EUICC_KEY(dev_3,tid_3,k)) is false.)
-- Query not attacker_p1(secret_payload[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 167 rules (82 with conclusion selected). Queue: 4 rules.
Starting query not attacker_p1(secret_payload[])
RESULT not attacker_p1(secret_payload[]) is true.
-- Query not attacker_p1(secret_payload[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 167 rules (82 with conclusion selected). Queue: 4 rules.
Starting query not attacker_p1(secret_payload[])
RESULT not attacker_p1(secret_payload[]) is true.
-- Query inj-event(SMDP_VERIFIED_FINISHED(dev_3,tid_3,transcript_2)) ==> inj-event(EUICC_SENT_FINISHED(dev_3,tid_3,transcript_2)) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 165 rules (80 with conclusion selected). Queue: 8 rules.
Starting query inj-event(SMDP_VERIFIED_FINISHED(dev_3,tid_3,transcript_2)) ==> inj-event(EUICC_SENT_FINISHED(dev_3,tid_3,transcript_2))
goal reachable: b-inj-event(EUICC_SENT_FINISHED(devMain[],tid_3,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),@occ104_2) && attacker(tid_3) -> inj-event(SMDP_VERIFIED_FINISHED(devMain[],tid_4,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),@occ45_1)
Abbreviations:
SK_EUICC_KEM_1 = SK_EUICC_KEM[!1 = @sid]
SK_EUICC_EPH_1 = SK_EUICC_EPH[!1 = @sid]
eChal_2 = eChal_1[dev_in = devMain[],!1 = @sid]
tid_4 = tid[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
serverNonce_3 = serverNonce[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_eph_1 = r_eph[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_client_1 = r_client[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_server_1 = r_server[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_3,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
@occ45_1 = @occ45[Finished_EU_in = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),CT_SERVER = kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),tid2 = tid_4,devS2 = devMain[],CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
@occ104_2 = @occ104_1[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_3,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]

Derivation:
Abbreviations:
SK_EUICC_KEM_1 = SK_EUICC_KEM[!1 = @sid]
SK_EUICC_EPH_1 = SK_EUICC_EPH[!1 = @sid]
eChal_2 = eChal_1[dev_in = devMain[],!1 = @sid]
tid_3 = tid[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
serverNonce_3 = serverNonce[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_eph_1 = r_eph[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_client_1 = r_client[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_server_1 = r_server[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_4,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
@occ45_1 = @occ45[Finished_EU_in = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),CT_SERVER = kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),tid2 = tid_3,devS2 = devMain[],CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
@occ104_2 = @occ104_1[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_4,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]

1. The message make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)) may be sent to the attacker at output {75}.
attacker(make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).

2. The message (t_getChal,ID_LPA,devMain[]) may be sent to the attacker at output {53}.
attacker((t_getChal,ID_LPA,devMain[])).

3. By 2, the attacker may know (t_getChal,ID_LPA,devMain[]).
Using the function 3-proj-3-tuple the attacker may obtain devMain[].
attacker(devMain[]).

4. Using the function ID_LPA the attacker may obtain ID_LPA.
attacker(ID_LPA).

5. Using the function t_getChal the attacker may obtain t_getChal.
attacker(t_getChal).

6. By 5, the attacker may know t_getChal.
By 4, the attacker may know ID_LPA.
By 3, the attacker may know devMain[].
Using the function 3-tuple the attacker may obtain (t_getChal,ID_LPA,devMain[]).
attacker((t_getChal,ID_LPA,devMain[])).

7. The message (t_getChal,ID_LPA,devMain[]) that the attacker may have by 6 may be received at input {78}.
So the message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) may be sent to the attacker at output {81}.
attacker((devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)))).

8. By 7, the attacker may know (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
Using the function 3-proj-4-tuple the attacker may obtain kem_pk(SK_EUICC_EPH_1).
attacker(kem_pk(SK_EUICC_EPH_1)).

9. By 7, the attacker may know (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
Using the function 2-proj-4-tuple the attacker may obtain eChal_2.
attacker(eChal_2).

10. By 3, the attacker may know devMain[].
By 9, the attacker may know eChal_2.
By 8, the attacker may know kem_pk(SK_EUICC_EPH_1).
By 1, the attacker may know make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)).
Using the function 4-tuple the attacker may obtain (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
attacker((devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)))).

11. The message make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) may be sent to the attacker at output {12}.
attacker(make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).

12. The message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) that the attacker may have by 10 may be received at input {13}.
So the message (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))) may be sent to the attacker at output {35}.
attacker((devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).

13. By 12, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 5-proj-6-tuple the attacker may obtain serverNonce_3.
attacker(serverNonce_3).

14. By 12, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 4-proj-6-tuple the attacker may obtain kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
attacker(kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1)).

15. By 14, the attacker may know kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
Using the function 2-proj-kem_enc the attacker may obtain r_client_1.
attacker(r_client_1).

16. By 1, the attacker may know make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)).
Using the function get_cert_kempk the attacker may obtain kem_pk(SK_EUICC_KEM_1).
attacker(kem_pk(SK_EUICC_KEM_1)).

17. By 16, the attacker may know kem_pk(SK_EUICC_KEM_1).
By 15, the attacker may know r_client_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
attacker(kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1)).

18. By 12, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 3-proj-6-tuple the attacker may obtain kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
attacker(kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1)).

19. By 18, the attacker may know kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
Using the function 2-proj-kem_enc the attacker may obtain r_eph_1.
attacker(r_eph_1).

20. By 8, the attacker may know kem_pk(SK_EUICC_EPH_1).
By 19, the attacker may know r_eph_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
attacker(kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1)).

21. We assume as hypothesis that
attacker(tid_4).

22. By 3, the attacker may know devMain[].
By 21, the attacker may know tid_4.
By 20, the attacker may know kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
By 17, the attacker may know kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
By 13, the attacker may know serverNonce_3.
By 11, the attacker may know make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)).
Using the function 6-tuple the attacker may obtain (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
attacker((devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).

23. The message (t_getChal,ID_LPA,devMain[]) that the attacker may have by 6 may be received at input {78}.
The message (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))) that the attacker may have by 22 may be received at input {82}.
The event EUICC_SENT_FINISHED(devMain[],tid_4,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) (with occurrence name @occ104_2) may be executed at {104}.
So the message (devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))) may be sent to the attacker at output {107}.
attacker((devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).

24. By 23, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
Using the function 4-proj-4-tuple the attacker may obtain kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).
attacker(kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).

25. By 23, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
Using the function 3-proj-4-tuple the attacker may obtain kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
attacker(kem_enc(kem_pk(SK_SMDP_KEM),r_server_1)).

26. By 25, the attacker may know kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
Using the function 2-proj-kem_enc the attacker may obtain r_server_1.
attacker(r_server_1).

27. By 11, the attacker may know make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)).
Using the function get_cert_kempk the attacker may obtain kem_pk(SK_SMDP_KEM).
attacker(kem_pk(SK_SMDP_KEM)).

28. By 27, the attacker may know kem_pk(SK_SMDP_KEM).
By 26, the attacker may know r_server_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
attacker(kem_enc(kem_pk(SK_SMDP_KEM),r_server_1)).

29. By 12, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 2-proj-6-tuple the attacker may obtain tid_3.
attacker(tid_3).

30. By 3, the attacker may know devMain[].
By 29, the attacker may know tid_3.
By 28, the attacker may know kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
By 24, the attacker may know kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).
Using the function 4-tuple the attacker may obtain (devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
attacker((devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).

31. The message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) that the attacker may have by 10 may be received at input {13}.
The message (devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))) that the attacker may have by 30 may be received at input {36}.
So event SMDP_VERIFIED_FINISHED(devMain[],tid_3,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) may be executed at {45} in session @sid_1.
inj-event(SMDP_VERIFIED_FINISHED(devMain[],tid_3,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),@occ45_1).

32. By 31, inj-event(SMDP_VERIFIED_FINISHED(devMain[],tid_3,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),@occ45_1).
The goal is reached, represented in the following fact:
inj-event(SMDP_VERIFIED_FINISHED(devMain[],tid_3,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),@occ45_1).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, ~M) with ~M = pq_sig_pk(SK_ROOT_CA) at {2}

new devMain: Id_t creating devMain_1 at {3}

new SK_EUICC_KEM: KEMsk_t creating SK_EUICC_KEM_2 at {68} in copy a

out(c, ~M_1) with ~M_1 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {75} in copy a

new SK_EUICC_EPH: KEMsk_t creating SK_EUICC_EPH_2 at {76} in copy a

out(LPA2EUICC, (~M_2,~M_3,~M_4)) with ~M_2 = t_getChal, ~M_3 = ID_LPA, ~M_4 = devMain_1 at {53} in copy a_1

out(c, ~M_5) with ~M_5 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {12} in copy a_2

out(c, ~M_6) with ~M_6 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {12} in copy a_3

in(LPA2EUICC, (t_getChal,ID_LPA,~M_4)) with ~M_4 = devMain_1 at {78} in copy a

new eChal_1: Nonce_t creating eChal_3 at {80} in copy a

out(LPA2EUICC, (~M_7,~M_8,~M_9,~M_10)) with ~M_7 = devMain_1, ~M_8 = eChal_3, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_10 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {81} in copy a

in(LPA2SMDP, (~M_4,~M_8,~M_9,~M_1)) with ~M_4 = devMain_1, ~M_8 = eChal_3, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_1 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {13} in copy a_2

new tid: Tid_t creating tid_5 at {25} in copy a_2

new serverNonce: Nonce_t creating serverNonce_4 at {26} in copy a_2

event SMDP_BEGIN(devMain_1,tid_5,eChal_3,serverNonce_4) at {27} in copy a_2

new r_eph: KEMcoin_t creating r_eph_2 at {28} in copy a_2

new r_client: KEMcoin_t creating r_client_2 at {31} in copy a_2

event SMDP_SENT_AUTH(devMain_1,tid_5,eChal_3,serverNonce_4,ID_SMDP) at {34} in copy a_2

out(LPA2SMDP, (~M_11,~M_12,kem_enc(~M_13,~M_14),kem_enc(~M_15,~M_16),~M_17,~M_18)) with ~M_11 = devMain_1, ~M_12 = tid_5, ~M_13 = kem_pk(SK_EUICC_EPH_2), ~M_14 = r_eph_2, ~M_15 = kem_pk(SK_EUICC_KEM_2), ~M_16 = r_client_2, ~M_17 = serverNonce_4, ~M_18 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {35} in copy a_2

in(LPA2EUICC, (~M_4,a_4,kem_enc(~M_9,~M_14),kem_enc(get_cert_kempk(~M_1),~M_16),~M_17,~M_5)) with ~M_4 = devMain_1, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_14 = r_eph_2, get_cert_kempk(~M_1) = kem_pk(SK_EUICC_KEM_2), ~M_16 = r_client_2, ~M_17 = serverNonce_4, ~M_5 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {82} in copy a

new r_server: KEMcoin_t creating r_server_2 at {96} in copy a

event EUICC_SENT_FINISHED(devMain_1,a_4,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {104} in copy a

event EUICC_KEY(devMain_1,a_4,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {105} in copy a

out(c, ~M_19) with ~M_19 = senc_test(secret_payload,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {106} in copy a

out(LPA2EUICC, (~M_20,~M_21,kem_enc(~M_22,~M_23),~M_24)) with ~M_20 = devMain_1, ~M_21 = a_4, ~M_22 = kem_pk(SK_SMDP_KEM), ~M_23 = r_server_2, ~M_24 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {107} in copy a

in(LPA2SMDP, (~M_4,~M_12,kem_enc(get_cert_kempk(~M_5),~M_23),~M_24)) with ~M_4 = devMain_1, ~M_12 = tid_5, get_cert_kempk(~M_5) = kem_pk(SK_SMDP_KEM), ~M_23 = r_server_2, ~M_24 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {36} in copy a_2

event SMDP_VERIFIED_FINISHED(devMain_1,tid_5,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {45} in copy a_2 (goal)

The event SMDP_VERIFIED_FINISHED(devMain_1,tid_5,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) is executed at {45} in copy a_2.
A trace has been found.
RESULT inj-event(SMDP_VERIFIED_FINISHED(dev_3,tid_3,transcript_2)) ==> inj-event(EUICC_SENT_FINISHED(dev_3,tid_3,transcript_2)) is false.
RESULT (even event(SMDP_VERIFIED_FINISHED(dev_3,tid_3,transcript_2)) ==> event(EUICC_SENT_FINISHED(dev_3,tid_3,transcript_2)) is false.)
-- Query inj-event(EUICC_VERIFIED_FINISHED(dev_3,tid_3,transcript_2)) ==> inj-event(SMDP_SENT_FINISHED(dev_3,tid_3,transcript_2)) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 165 rules (81 with conclusion selected). Queue: 7 rules.
Starting query inj-event(EUICC_VERIFIED_FINISHED(dev_3,tid_3,transcript_2)) ==> inj-event(SMDP_SENT_FINISHED(dev_3,tid_3,transcript_2))
goal reachable: b-inj-event(SMDP_SENT_FINISHED(devMain[],tid_3,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),@occ48_1) && attacker(tid_4) -> inj-event(EUICC_VERIFIED_FINISHED(devMain[],tid_4,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),@occ112_1)
Abbreviations:
eChal_2 = eChal_1[dev_in = devMain[],!1 = @sid]
SK_EUICC_KEM_1 = SK_EUICC_KEM[!1 = @sid]
SK_EUICC_EPH_1 = SK_EUICC_EPH[!1 = @sid]
serverNonce_3 = serverNonce[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_eph_1 = r_eph[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_client_1 = r_client[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_server_1 = r_server[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_4,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
@occ112_1 = @occ112[Finished_DP_in = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))),tid3_1 = tid_4,dev_in3 = devMain[],CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_4,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
tid_3 = tid[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
@occ48_1 = @occ48[Finished_EU_in = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),CT_SERVER = kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),tid2 = tid_3,devS2 = devMain[],CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]

Derivation:
Abbreviations:
eChal_2 = eChal_1[dev_in = devMain[],!1 = @sid]
SK_EUICC_KEM_1 = SK_EUICC_KEM[!1 = @sid]
SK_EUICC_EPH_1 = SK_EUICC_EPH[!1 = @sid]
serverNonce_3 = serverNonce[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_eph_1 = r_eph[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_client_1 = r_client[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
r_server_1 = r_server[CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_3,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
@occ112_1 = @occ112[Finished_DP_in = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))),tid3_1 = tid_3,dev_in3 = devMain[],CERT_SMDP_1 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),serverNonce_2 = serverNonce_3,CT_CLIENT_2 = kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),CT_EPH_2 = kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),tid_2 = tid_3,dev_in2 = devMain[],dev_in = devMain[],!1 = @sid]
tid_4 = tid[CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]
@occ48_1 = @occ48[Finished_EU_in = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),CT_SERVER = kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),tid2 = tid_4,devS2 = devMain[],CERT_EUICC = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),PK_EUICC_EPH = kem_pk(SK_EUICC_EPH_1),eChalS = eChal_2,devS = devMain[],!1 = @sid_1]

1. The message (t_getChal,ID_LPA,devMain[]) may be sent to the attacker at output {53}.
attacker((t_getChal,ID_LPA,devMain[])).

2. By 1, the attacker may know (t_getChal,ID_LPA,devMain[]).
Using the function 3-proj-3-tuple the attacker may obtain devMain[].
attacker(devMain[]).

3. Using the function ID_LPA the attacker may obtain ID_LPA.
attacker(ID_LPA).

4. Using the function t_getChal the attacker may obtain t_getChal.
attacker(t_getChal).

5. By 4, the attacker may know t_getChal.
By 3, the attacker may know ID_LPA.
By 2, the attacker may know devMain[].
Using the function 3-tuple the attacker may obtain (t_getChal,ID_LPA,devMain[]).
attacker((t_getChal,ID_LPA,devMain[])).

6. The message make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) may be sent to the attacker at output {12}.
attacker(make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).

7. The message make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)) may be sent to the attacker at output {75}.
attacker(make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).

8. The message (t_getChal,ID_LPA,devMain[]) that the attacker may have by 5 may be received at input {78}.
So the message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) may be sent to the attacker at output {81}.
attacker((devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)))).

9. By 8, the attacker may know (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
Using the function 3-proj-4-tuple the attacker may obtain kem_pk(SK_EUICC_EPH_1).
attacker(kem_pk(SK_EUICC_EPH_1)).

10. By 8, the attacker may know (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
Using the function 2-proj-4-tuple the attacker may obtain eChal_2.
attacker(eChal_2).

11. By 2, the attacker may know devMain[].
By 10, the attacker may know eChal_2.
By 9, the attacker may know kem_pk(SK_EUICC_EPH_1).
By 7, the attacker may know make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)).
Using the function 4-tuple the attacker may obtain (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))).
attacker((devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)))).

12. The message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) that the attacker may have by 11 may be received at input {13}.
So the message (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))) may be sent to the attacker at output {35}.
attacker((devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).

13. By 12, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 5-proj-6-tuple the attacker may obtain serverNonce_3.
attacker(serverNonce_3).

14. By 12, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 4-proj-6-tuple the attacker may obtain kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
attacker(kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1)).

15. By 14, the attacker may know kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
Using the function 2-proj-kem_enc the attacker may obtain r_client_1.
attacker(r_client_1).

16. By 7, the attacker may know make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)).
Using the function get_cert_kempk the attacker may obtain kem_pk(SK_EUICC_KEM_1).
attacker(kem_pk(SK_EUICC_KEM_1)).

17. By 16, the attacker may know kem_pk(SK_EUICC_KEM_1).
By 15, the attacker may know r_client_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
attacker(kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1)).

18. By 12, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 3-proj-6-tuple the attacker may obtain kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
attacker(kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1)).

19. By 18, the attacker may know kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
Using the function 2-proj-kem_enc the attacker may obtain r_eph_1.
attacker(r_eph_1).

20. By 9, the attacker may know kem_pk(SK_EUICC_EPH_1).
By 19, the attacker may know r_eph_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
attacker(kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1)).

21. We assume as hypothesis that
attacker(tid_3).

22. By 2, the attacker may know devMain[].
By 21, the attacker may know tid_3.
By 20, the attacker may know kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1).
By 17, the attacker may know kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1).
By 13, the attacker may know serverNonce_3.
By 6, the attacker may know make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)).
Using the function 6-tuple the attacker may obtain (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
attacker((devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).

23. The message (t_getChal,ID_LPA,devMain[]) that the attacker may have by 5 may be received at input {78}.
The message (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))) that the attacker may have by 22 may be received at input {82}.
So the message (devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))) may be sent to the attacker at output {107}.
attacker((devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).

24. By 23, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
Using the function 4-proj-4-tuple the attacker may obtain kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).
attacker(kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).

25. By 23, the attacker may know (devMain[],tid_3,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
Using the function 3-proj-4-tuple the attacker may obtain kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
attacker(kem_enc(kem_pk(SK_SMDP_KEM),r_server_1)).

26. By 25, the attacker may know kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
Using the function 2-proj-kem_enc the attacker may obtain r_server_1.
attacker(r_server_1).

27. By 6, the attacker may know make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)).
Using the function get_cert_kempk the attacker may obtain kem_pk(SK_SMDP_KEM).
attacker(kem_pk(SK_SMDP_KEM)).

28. By 27, the attacker may know kem_pk(SK_SMDP_KEM).
By 26, the attacker may know r_server_1.
Using the function kem_enc the attacker may obtain kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
attacker(kem_enc(kem_pk(SK_SMDP_KEM),r_server_1)).

29. By 12, the attacker may know (devMain[],tid_4,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))).
Using the function 2-proj-6-tuple the attacker may obtain tid_4.
attacker(tid_4).

30. By 2, the attacker may know devMain[].
By 29, the attacker may know tid_4.
By 28, the attacker may know kem_enc(kem_pk(SK_SMDP_KEM),r_server_1).
By 24, the attacker may know kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))).
Using the function 4-tuple the attacker may obtain (devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))).
attacker((devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).

31. The message (devMain[],eChal_2,kem_pk(SK_EUICC_EPH_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA))) that the attacker may have by 11 may be received at input {13}.
The message (devMain[],tid_4,kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))) that the attacker may have by 30 may be received at input {36}.
The event SMDP_SENT_FINISHED(devMain[],tid_4,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) (with occurrence name @occ48_1) may be executed at {48}.
So the message (devMain[],tid_4,kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))))) may be sent to the attacker at output {49}.
attacker((devMain[],tid_4,kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))))).

32. By 31, the attacker may know (devMain[],tid_4,kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))))).
Using the function 3-proj-3-tuple the attacker may obtain kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).
attacker(kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))))).

33. By 2, the attacker may know devMain[].
By 21, the attacker may know tid_3.
By 32, the attacker may know kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))).
Using the function 3-tuple the attacker may obtain (devMain[],tid_3,kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))))).
attacker((devMain[],tid_3,kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))))).

34. The message (t_getChal,ID_LPA,devMain[]) that the attacker may have by 5 may be received at input {78}.
The message (devMain[],tid_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),serverNonce_3,make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))) that the attacker may have by 22 may be received at input {82}.
The message (devMain[],tid_3,kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_ss(kem_pk(SK_SMDP_KEM),r_server_1),kem_ss(kem_pk(SK_EUICC_KEM_1),r_client_1),eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))))))) that the attacker may have by 33 may be received at input {108}.
So event EUICC_VERIFIED_FINISHED(devMain[],tid_3,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) may be executed at {112} in session @sid.
inj-event(EUICC_VERIFIED_FINISHED(devMain[],tid_3,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),@occ112_1).

35. By 34, inj-event(EUICC_VERIFIED_FINISHED(devMain[],tid_3,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),@occ112_1).
The goal is reached, represented in the following fact:
inj-event(EUICC_VERIFIED_FINISHED(devMain[],tid_3,transcript_hash(eChal_2,serverNonce_3,kem_enc(kem_pk(SK_EUICC_EPH_1),r_eph_1),kem_enc(kem_pk(SK_EUICC_KEM_1),r_client_1),kem_enc(kem_pk(SK_SMDP_KEM),r_server_1),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_1),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))),@occ112_1).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, ~M) with ~M = pq_sig_pk(SK_ROOT_CA) at {2}

new devMain: Id_t creating devMain_1 at {3}

new SK_EUICC_KEM: KEMsk_t creating SK_EUICC_KEM_2 at {68} in copy a

out(c, ~M_1) with ~M_1 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {75} in copy a

new SK_EUICC_EPH: KEMsk_t creating SK_EUICC_EPH_2 at {76} in copy a

out(LPA2EUICC, (~M_2,~M_3,~M_4)) with ~M_2 = t_getChal, ~M_3 = ID_LPA, ~M_4 = devMain_1 at {53} in copy a_1

out(c, ~M_5) with ~M_5 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {12} in copy a_2

out(c, ~M_6) with ~M_6 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {12} in copy a_3

in(LPA2EUICC, (t_getChal,ID_LPA,~M_4)) with ~M_4 = devMain_1 at {78} in copy a

new eChal_1: Nonce_t creating eChal_3 at {80} in copy a

out(LPA2EUICC, (~M_7,~M_8,~M_9,~M_10)) with ~M_7 = devMain_1, ~M_8 = eChal_3, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_10 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {81} in copy a

in(LPA2SMDP, (~M_4,~M_8,~M_9,~M_1)) with ~M_4 = devMain_1, ~M_8 = eChal_3, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_1 = make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)) at {13} in copy a_3

new tid: Tid_t creating tid_5 at {25} in copy a_3

new serverNonce: Nonce_t creating serverNonce_4 at {26} in copy a_3

event SMDP_BEGIN(devMain_1,tid_5,eChal_3,serverNonce_4) at {27} in copy a_3

new r_eph: KEMcoin_t creating r_eph_2 at {28} in copy a_3

new r_client: KEMcoin_t creating r_client_2 at {31} in copy a_3

event SMDP_SENT_AUTH(devMain_1,tid_5,eChal_3,serverNonce_4,ID_SMDP) at {34} in copy a_3

out(LPA2SMDP, (~M_11,~M_12,kem_enc(~M_13,~M_14),kem_enc(~M_15,~M_16),~M_17,~M_18)) with ~M_11 = devMain_1, ~M_12 = tid_5, ~M_13 = kem_pk(SK_EUICC_EPH_2), ~M_14 = r_eph_2, ~M_15 = kem_pk(SK_EUICC_KEM_2), ~M_16 = r_client_2, ~M_17 = serverNonce_4, ~M_18 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {35} in copy a_3

in(LPA2EUICC, (~M_4,a_4,kem_enc(~M_9,~M_14),kem_enc(get_cert_kempk(~M_1),~M_16),~M_17,~M_5)) with ~M_4 = devMain_1, ~M_9 = kem_pk(SK_EUICC_EPH_2), ~M_14 = r_eph_2, get_cert_kempk(~M_1) = kem_pk(SK_EUICC_KEM_2), ~M_16 = r_client_2, ~M_17 = serverNonce_4, ~M_5 = make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)) at {82} in copy a

new r_server: KEMcoin_t creating r_server_2 at {96} in copy a

event EUICC_SENT_FINISHED(devMain_1,a_4,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {104} in copy a

event EUICC_KEY(devMain_1,a_4,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {105} in copy a

out(c, ~M_19) with ~M_19 = senc_test(secret_payload,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {106} in copy a

out(LPA2EUICC, (~M_20,~M_21,kem_enc(~M_22,~M_23),~M_24)) with ~M_20 = devMain_1, ~M_21 = a_4, ~M_22 = kem_pk(SK_SMDP_KEM), ~M_23 = r_server_2, ~M_24 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {107} in copy a

in(LPA2SMDP, (~M_4,~M_12,kem_enc(get_cert_kempk(~M_5),~M_23),~M_24)) with ~M_4 = devMain_1, ~M_12 = tid_5, get_cert_kempk(~M_5) = kem_pk(SK_SMDP_KEM), ~M_23 = r_server_2, ~M_24 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {36} in copy a_3

event SMDP_VERIFIED_FINISHED(devMain_1,tid_5,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {45} in copy a_3

event SMDP_KEY(devMain_1,tid_5,kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)) at {46} in copy a_3

event SMDP_SENT_FINISHED(devMain_1,tid_5,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {48} in copy a_3

out(LPA2SMDP, (~M_25,~M_26,~M_27)) with ~M_25 = devMain_1, ~M_26 = tid_5, ~M_27 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))) at {49} in copy a_3

event SMDP_AUTH_OK(devMain_1,tid_5,serverNonce_4,ID_EUICC) at {50} in copy a_3

in(LPA2EUICC, (~M_4,a_4,~M_27)) with ~M_4 = devMain_1, ~M_27 = kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),(transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA))),kem_mac(get_KM(kemtls_kdf(kem_ss(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_ss(kem_pk(SK_SMDP_KEM),r_server_2),kem_ss(kem_pk(SK_EUICC_KEM_2),r_client_2),eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)),ID_EUICC,ID_SMDP)),transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))))) at {108} in copy a

event EUICC_VERIFIED_FINISHED(devMain_1,a_4,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) at {112} in copy a (goal)

The event EUICC_VERIFIED_FINISHED(devMain_1,a_4,transcript_hash(eChal_3,serverNonce_4,kem_enc(kem_pk(SK_EUICC_EPH_2),r_eph_2),kem_enc(kem_pk(SK_EUICC_KEM_2),r_client_2),kem_enc(kem_pk(SK_SMDP_KEM),r_server_2),make_cert(ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu,pq_sign((ID_EUICC,kem_pk(SK_EUICC_KEM_2),tag_eu),SK_ROOT_CA)),make_cert(ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp,pq_sign((ID_SMDP,kem_pk(SK_SMDP_KEM),tag_dp),SK_ROOT_CA)))) is executed at {112} in copy a.
A trace has been found.
RESULT inj-event(EUICC_VERIFIED_FINISHED(dev_3,tid_3,transcript_2)) ==> inj-event(SMDP_SENT_FINISHED(dev_3,tid_3,transcript_2)) is false.
RESULT (even event(EUICC_VERIFIED_FINISHED(dev_3,tid_3,transcript_2)) ==> event(SMDP_SENT_FINISHED(dev_3,tid_3,transcript_2)) is false.)

--------------------------------------------------------------
Verification summary:

Query inj-event(EUICC_AUTH_OK(dev_3,tid_3,e,s,ID_SMDP)) ==> inj-event(SMDP_SENT_AUTH(dev_3,tid_3,e,s,ID_SMDP)) is false.

Query inj-event(SMDP_AUTH_OK(dev_3,tid_3,s,ID_EUICC)) ==> inj-event(EUICC_SENT_FINISHED(dev_3,tid_3,transcript_2)) is false.

Query inj-event(SMDP_KEY(dev_3,tid_3,k)) ==> inj-event(EUICC_KEY(dev_3,tid_3,k)) is false.

Query not attacker_p1(secret_payload[]) is true.

Query not attacker_p1(secret_payload[]) is true.

Query inj-event(SMDP_VERIFIED_FINISHED(dev_3,tid_3,transcript_2)) ==> inj-event(EUICC_SENT_FINISHED(dev_3,tid_3,transcript_2)) is false.

Query inj-event(EUICC_VERIFIED_FINISHED(dev_3,tid_3,transcript_2)) ==> inj-event(SMDP_SENT_FINISHED(dev_3,tid_3,transcript_2)) is false.

--------------------------------------------------------------

